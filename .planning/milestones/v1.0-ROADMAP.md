# Milestone v1.0: MVP

**Status:** SHIPPED 2026-01-30
**Phases:** 1-11
**Total Plans:** 67

## Overview

Findo delivers autonomous SMB management through 11 phases that build from infrastructure to intelligence. The journey starts with multi-tenant foundations and WhatsApp integration (the core communication channel), progresses through lead capture and review management (the core value proposition), adds GBP content automation and optimization (the differentiators), and concludes with onboarding polish and billing (the business enablers). Every phase delivers observable value; together they create a system that operates 24/7 without owner intervention after a 2-minute setup.

## Phases

### Phase 1: Foundation

**Goal**: Infrastructure that isolates tenants, processes webhooks reliably, and secures credentials
**Depends on**: Nothing (first phase)
**Plans**: 8 plans

Plans:
- [x] 01-01: Initialize project with TypeScript, Hono, and database schema
- [x] 01-02: Row-Level Security and tenant context middleware
- [x] 01-03: Encrypted token vault for credentials
- [x] 01-04: BullMQ queue infrastructure
- [x] 01-05: Webhook endpoints and activity service
- [x] 01-06: Background job scheduler
- [x] 01-07: Activity feed SSE and verification scripts
- [x] 01-08: Gap closure: Redis warm-up and RLS GRANT statements

**Details:**
- Multi-tenant architecture with UUID primary keys
- Row-Level Security with app.current_tenant session variable
- AES-256-GCM encryption with per-value salt and IV
- Four queue types: webhooks, scheduled, notifications, activity
- Exponential backoff retry strategy

---

### Phase 2: WhatsApp Integration

**Goal**: Business owners can connect WhatsApp in one click and system can send/receive messages
**Depends on**: Phase 1
**Plans**: 6 plans

Plans:
- [x] 02-01: WhatsApp database schema and Graph API client service
- [x] 02-02: Embedded Signup callback endpoint for token exchange
- [x] 02-03: Webhook handler with signature verification
- [x] 02-04: Message and status processing workers
- [x] 02-05: Daily token validation job
- [x] 02-06: Frontend UI for Connect WhatsApp button and Meta Embedded Signup

**Details:**
- Meta Graph API v21.0 integration
- Timing-safe HMAC signature verification
- Separate queues for messages vs statuses
- Hebrew UI with RTL layout

---

### Phase 3: Lead Capture

**Goal**: Missed calls become qualified leads delivered to business owner via WhatsApp
**Depends on**: Phase 2
**Plans**: 6 plans

Plans:
- [x] 03-01: Lead database schema and Voicenter types
- [x] 03-02: Voicenter webhook endpoint and CDR processing worker
- [x] 03-03: Lead outreach worker (2-minute delayed WhatsApp)
- [x] 03-04: Chatbot state machine and AI intent extraction
- [x] 03-05: Lead message handler and owner notifications
- [x] 03-06: Reminder system (2h and 24h follow-ups)

**Details:**
- 7-state lead lifecycle
- Claude Haiku 4.5 for intent extraction
- Warm personal message tone in Hebrew
- Phone normalization to +972 format

---

### Phase 4: Google Integration

**Goal**: Business owners can connect Google and system can read/write to their GBP
**Depends on**: Phase 1
**Plans**: 4 plans

Plans:
- [x] 04-01: Google OAuth foundation (schema, OAuth service, callback routes)
- [x] 04-02: Google API services (profile and reviews)
- [x] 04-03: Token refresh worker (proactive refresh every 5 minutes)
- [x] 04-04: Google connection frontend UI (Hebrew, RTL)

**Details:**
- business.manage scope for reviews and profile
- 10-minute expiry window for proactive refresh
- Direct HTTP for reviews API (googleapis types incomplete)
- Star rating enum to number conversion

---

### Phase 5: Review Management

**Goal**: Positive reviews get auto-replies; negative reviews get drafted responses awaiting owner approval
**Depends on**: Phase 4
**Plans**: 6 plans

Plans:
- [x] 05-01: Review tracking database schema
- [x] 05-02: AI reply generator with Claude Haiku 4.5
- [x] 05-03: Review poll worker for hourly detection and auto-reply
- [x] 05-04: Owner notification with WhatsApp interactive buttons
- [x] 05-05: Owner response handler for approve/edit workflow
- [x] 05-06: 48h reminder and auto-post system

**Details:**
- Claude Haiku 4.5 with structured outputs for JSON
- 3-star reviews default to negative (safer)
- Window-aware owner notifications
- 48h reminder then 48h auto-post threshold

---

### Phase 6: Review Requests

**Goal**: Customers receive review requests automatically after service, with smart follow-up
**Depends on**: Phase 2, Phase 4
**Plans**: 7 plans

Plans:
- [x] 06-01: Review request schema and accounting connections
- [x] 06-02: Greeninvoice API client (JWT auth, document search)
- [x] 06-03: iCount API client (session auth, document search)
- [x] 06-04: Invoice poll worker (hourly detection, 24h delayed jobs)
- [x] 06-05: Review request worker (WhatsApp templates, 3-day reminder)
- [x] 06-06: Manual trigger UI (dashboard form)
- [x] 06-07: Review completion detection (cross-reference with review poll)

**Details:**
- 6-state review request lifecycle
- Polling required (neither accounting provider has webhooks)
- 24-hour delay before sending request
- 3-day reminder then stop (no spam)

---

### Phase 7: GBP Content

**Goal**: Business's Google profile stays fresh with regular photos and promotional posts
**Depends on**: Phase 4
**Plans**: 8 plans

Plans:
- [x] 07-01: Photo request schema and weekly worker
- [x] 07-02: Media services (WhatsApp download, image validation, GBP upload)
- [x] 07-03: Photo upload flow and message handler integration
- [x] 07-04: Promotional posts schema and monthly worker
- [x] 07-05: AI post generator and approval workflow
- [x] 07-06: Holiday hours checker with @hebcal/core
- [x] 07-07: Gap closure: Register Phase 7 workers in index.ts
- [x] 07-08: Gap closure: UAT fixes (confirmation messages, worker logging)

**Details:**
- Thursday 10AM for photo requests (end of Israeli work week)
- Laplacian variance for blur detection
- @hebcal/core for Israeli holidays
- Phone number validation in posts (Google policy)

---

### Phase 8: GBP Optimization

**Goal**: System monitors GBP metrics and autonomously optimizes for better performance
**Depends on**: Phase 5, Phase 6, Phase 7
**Plans**: 7 plans

Plans:
- [x] 08-01: Optimization schema (metrics, A/B tests, baselines, config)
- [x] 08-02: GBP Performance API service (visibility and content metrics)
- [x] 08-03: Metrics collection worker (weekly aggregation and baselines)
- [x] 08-04: Metrics dashboard API and view
- [x] 08-05: Alert detection and WhatsApp notifications
- [x] 08-06: A/B testing framework and review request integration
- [x] 08-07: Auto-tuning engine and weekly summary notifications

**Details:**
- Business Profile Performance API v1 for metrics
- 4+ weeks for baseline, 8 weeks max
- 30% drop threshold for alerts
- 20% improvement with 10+ samples for A/B winner

---

### Phase 9: Dashboard & Notifications

**Goal**: Business owner has confidence window showing Findo is working, with WhatsApp-first interactions
**Depends on**: Phase 3, Phase 5, Phase 8
**Plans**: 8 plans

Plans:
- [x] 09-01: Notification preferences and chatbot config schema
- [x] 09-02: Stats aggregator and health checker services
- [x] 09-03: Main dashboard view with health status and stats
- [x] 09-04: Activity feed with smart grouping and real-time updates
- [x] 09-05: Reports page with Chart.js trend graphs
- [x] 09-06: Settings pages (timing, notifications, chatbot)
- [x] 09-07: Dashboard actions (review approval, photo upload, post content)
- [x] 09-08: Notification preference integration into workers

**Details:**
- 10 boolean notification flags with sensible defaults
- Traffic light health indicator
- 100-item DOM limit for activity feed
- Notification gate pattern for preference enforcement

---

### Phase 10: Setup & Billing

**Goal**: New business completes setup in 2 minutes and pays for the service
**Depends on**: Phase 2, Phase 4, Phase 3
**Plans**: 6 plans

Plans:
- [x] 10-01: Billing and setup schema (subscriptions, payments, setup_progress)
- [x] 10-02: Setup wizard routes and views for steps 1-3 (business, WhatsApp, Google)
- [x] 10-03: Setup wizard steps 4-5 (telephony, billing) and complete page
- [x] 10-04: PayPlus payment integration (API client, routes, webhook)
- [x] 10-05: Progressive profiling worker (weekly WhatsApp questions)
- [x] 10-06: Integration wiring and end-to-end verification

**Details:**
- Agorot for currency storage (avoid floating point)
- 14-day trial without credit card
- PayPlus ChargeMethod.TOKEN_AND_CHARGE for recurring billing
- Stop profiling after 2 consecutive ignores

---

### Phase 11: Worker Registration (Gap Closure)

**Goal**: Register missing workers in src/index.ts to make Phases 5, 6, and 8 operational
**Depends on**: Phase 5, Phase 6, Phase 8
**Plans**: 1 plan

Plans:
- [x] 11-01: Register 6 missing workers in src/index.ts

**Details:**
- Auto-start pattern for metrics and auto-tuning workers
- Lazy-start pattern for poll and request workers
- Graceful shutdown handlers for all 6 workers

---

## Milestone Summary

**Key Decisions:**

- Hebrew only for v1 (simplify AI layer and UI)
- Meta Embedded Signup for WhatsApp (one-click connection)
- Voicenter for telephony (Israeli provider, webhook support)
- Greeninvoice as primary accounting (best API quality)
- Notification-driven UX over dashboard-driven
- Progressive profiling over long setup
- Claude Haiku 4.5 for AI (cost-effective, good Hebrew support)
- Queue-first architecture (fast webhook response, async processing)
- Row-Level Security for tenant isolation

**Issues Resolved:**

- GBP API has no webhooks → polling architecture
- Neither Greeninvoice nor iCount has invoice webhooks → hourly polling
- Google APIs types incomplete → direct HTTP for reviews
- WhatsApp session window limitation → text fallback for approvals

**Technical Debt:**

- RLS enforcement requires findo_app database user creation
- Human verification needed for: Meta popup, Hebrew quality, AI accuracy, RTL layout
- daily-digest job has placeholder implementation

---

*For current project status, see .planning/ROADMAP.md*

---

*Archived: 2026-01-30 as part of v1.0 milestone completion*
