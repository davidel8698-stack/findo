---
phase: 17-conversion-flow
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - website/lib/validation.ts
  - website/package.json
autonomous: true

must_haves:
  truths:
    - "Israeli phone numbers validate correctly (05X-XXX-XXXX)"
    - "Phone formatting works as user types"
    - "canvas-confetti is available for celebration animation"
  artifacts:
    - path: "website/lib/validation.ts"
      provides: "Israeli phone validation and formatting"
      exports: ["isValidIsraeliPhone", "formatIsraeliPhone"]
    - path: "website/package.json"
      provides: "canvas-confetti dependency"
      contains: "canvas-confetti"
  key_links:
    - from: "website/lib/validation.ts"
      to: "Israeli mobile patterns"
      via: "regex validation"
      pattern: "05[02345689]"
---

<objective>
Create foundation utilities for conversion flow: Israeli phone validation/formatting and confetti animation dependency.

Purpose: Enable real-time phone validation with Israeli format and celebration animations on signup success.
Output: Validation utility module and canvas-confetti package installed.
</objective>

<execution_context>
@C:\Users\דודאלמועלם\.claude\get-shit-done\workflows\execute-plan.md
@C:\Users\דודאלמועלם\.claude\get-shit-done\templates\summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/17-conversion-flow/17-CONTEXT.md
@.planning/phases/17-conversion-flow/17-RESEARCH.md
@website/lib/content.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install canvas-confetti dependency</name>
  <files>website/package.json</files>
  <action>
Install canvas-confetti and its TypeScript types using npm (not pnpm - OneDrive issues per STATE.md):

```bash
cd website && npm install canvas-confetti && npm install -D @types/canvas-confetti
```

This is a 1.9KB gzipped library for celebration animations. It includes the `disableForReducedMotion` option for accessibility.
  </action>
  <verify>
Run `npm ls canvas-confetti` in website directory shows version ^1.9.x installed.
Check package.json contains "canvas-confetti" in dependencies.
  </verify>
  <done>canvas-confetti and @types/canvas-confetti appear in package.json</done>
</task>

<task type="auto">
  <name>Task 2: Create Israeli phone validation utility</name>
  <files>website/lib/validation.ts</files>
  <action>
Create `website/lib/validation.ts` with two exported functions:

1. `isValidIsraeliPhone(phone: string): boolean`
   - Remove all non-digits from input
   - Validate: exactly 10 digits
   - Validate: starts with valid Israeli mobile prefix (050, 052, 053, 054, 055, 056, 058, 059)
   - Return boolean

2. `formatIsraeliPhone(phone: string): string`
   - Remove all non-digits
   - Format progressively as user types:
     - 3 digits or less: return as-is (e.g., "050")
     - 4-6 digits: format as "050-123"
     - 7+ digits: format as "050-123-4567"
   - Limit to 10 digits max

Reference the existing `formatPhone` in lib/content.ts for style consistency, but this is more comprehensive with validation.

Do NOT modify lib/content.ts - keep validation separate for cleaner imports.
  </action>
  <verify>
Create a quick test in the file comments or mentally verify:
- `isValidIsraeliPhone("0501234567")` returns true
- `isValidIsraeliPhone("050-123-4567")` returns true (strips non-digits)
- `isValidIsraeliPhone("0561234567")` returns true (056 is valid)
- `isValidIsraeliPhone("0591234567")` returns true (059 is valid)
- `isValidIsraeliPhone("0401234567")` returns false (invalid prefix)
- `isValidIsraeliPhone("050123456")` returns false (9 digits)
- `formatIsraeliPhone("050")` returns "050"
- `formatIsraeliPhone("050123")` returns "050-123"
- `formatIsraeliPhone("0501234567")` returns "050-123-4567"

Run `cd website && npx tsc --noEmit` to verify TypeScript compiles.
  </verify>
  <done>
validation.ts exports isValidIsraeliPhone and formatIsraeliPhone functions.
TypeScript compiles without errors.
  </done>
</task>

</tasks>

<verification>
1. `npm ls canvas-confetti` shows installed version
2. `website/lib/validation.ts` exists with both exported functions
3. `npx tsc --noEmit` passes in website directory
4. Functions handle edge cases (empty string, non-digits, partial input)
5. All 8 valid Israeli mobile prefixes accepted: 050, 052, 053, 054, 055, 056, 058, 059
</verification>

<success_criteria>
- canvas-confetti ^1.9.x installed with types
- isValidIsraeliPhone validates all Israeli mobile prefixes correctly (050, 052, 053, 054, 055, 056, 058, 059)
- formatIsraeliPhone formats progressively (050 -> 050-123 -> 050-123-4567)
- No TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/17-conversion-flow/17-01-SUMMARY.md`
</output>
