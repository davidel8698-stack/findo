---
phase: 17-conversion-flow
plan: 03
type: execute
wave: 3
depends_on: ["17-02"]
files_modified:
  - website/components/sections/conversion/ConversionSection.tsx
  - website/components/sections/hero/StickyCtaBar.tsx
  - website/app/page.tsx
autonomous: true

must_haves:
  truths:
    - "Form smoothly transitions to success state with animation"
    - "CTA appears 4-6 times on homepage (hero, after social proof, after pricing, after FAQ, footer area)"
    - "What happens next is clear below each CTA"
    - "Sticky mobile CTA scrolls to form when clicked"
    - "Social proof snippet appears near CTAs"
    - "Mobile sticky bar uses thumb zone and iOS safe area"
  artifacts:
    - path: "website/components/sections/conversion/ConversionSection.tsx"
      provides: "AnimatePresence wrapper for form/success transition"
      exports: ["ConversionSection"]
    - path: "website/components/sections/hero/StickyCtaBar.tsx"
      provides: "Updated sticky bar with scroll-to-form"
      exports: ["StickyCtaBar"]
    - path: "website/app/page.tsx"
      provides: "Homepage with strategic CTA placement"
  key_links:
    - from: "ConversionSection.tsx"
      to: "LeadCaptureForm.tsx"
      via: "AnimatePresence mode='wait'"
      pattern: "AnimatePresence"
    - from: "StickyCtaBar.tsx"
      to: "ConversionSection"
      via: "scrollIntoView"
      pattern: "getElementById.*scrollIntoView"
    - from: "page.tsx"
      to: "ConversionSection.tsx"
      via: "multiple placements"
      pattern: "ConversionSection.*id="
---

<objective>
Integrate conversion components into homepage with strategic CTA placement, animated transitions, and mobile optimization.

Purpose: Create multiple conversion opportunities throughout the page with consistent "what happens next" messaging and smooth form/success transitions.
Output: ConversionSection wrapper, updated StickyCtaBar, homepage with 4-6 CTAs.
</objective>

<execution_context>
@C:\Users\דודאלמועלם\.claude\get-shit-done\workflows\execute-plan.md
@C:\Users\דודאלמועלם\.claude\get-shit-done\templates\summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/17-conversion-flow/17-CONTEXT.md
@.planning/phases/17-conversion-flow/17-RESEARCH.md
@.planning/phases/17-conversion-flow/17-02-SUMMARY.md
@website/app/page.tsx
@website/components/sections/hero/StickyCtaBar.tsx
@website/components/sections/hero/HeroContent.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ConversionSection with AnimatePresence</name>
  <files>website/components/sections/conversion/ConversionSection.tsx</files>
  <action>
Create `ConversionSection.tsx` ("use client"):

1. Props interface:
   ```typescript
   interface ConversionSectionProps {
     id?: string;
     className?: string;
     showTrustText?: boolean;
     variant?: "hero" | "section" | "compact";
   }
   ```

2. Use useState for `isSuccess` boolean.

3. Render with AnimatePresence mode="wait" wrapping conditional content:
   - When `!isSuccess`: Render LeadCaptureForm with m.div wrapper
     - initial={{ opacity: 0, y: 20 }}
     - animate={{ opacity: 1, y: 0 }}
     - exit={{ opacity: 0, y: -20 }}
     - transition={{ duration: 0.3 }}
   - When `isSuccess`: Render FormSuccess with m.div wrapper
     - initial={{ opacity: 0, scale: 0.9 }}
     - animate={{ opacity: 1, scale: 1 }}
     - transition={{ duration: 0.3 }}

4. LeadCaptureForm's onSuccess prop sets isSuccess to true.

5. FormSuccess redirectUrl defaults to `process.env.NEXT_PUBLIC_APP_URL || "https://app.findo.co.il"`

6. Variants:
   - "hero": Full width, no background
   - "section": Centered, max-w-md, bg-card rounded-xl p-6 shadow-lg
   - "compact": Smaller padding, inline style

7. If showTrustText (default true for section/compact), show below form:
   - "573+ עסקים כבר משתמשים ב-Findo" (social proof near CTA - ACTION-08)

Import AnimatePresence and m from 'motion/react'.
  </action>
  <verify>
Component renders LeadCaptureForm initially.
After form success, animates to FormSuccess.
Variants apply correct styling.
`npx tsc --noEmit` passes.
  </verify>
  <done>
ConversionSection wraps form/success with smooth AnimatePresence transition.
Supports hero, section, and compact variants.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update StickyCtaBar with scroll-to-form</name>
  <files>website/components/sections/hero/StickyCtaBar.tsx</files>
  <action>
Update existing `StickyCtaBar.tsx` to scroll to the hero form when clicked:

1. Add `formId` prop (optional string, defaults to "hero-form"):
   ```typescript
   interface StickyCtaBarProps {
     className?: string;
     formId?: string;
   }
   ```

2. Add click handler to the Button:
   ```typescript
   const handleClick = () => {
     const formElement = document.getElementById(formId || "hero-form");
     if (formElement) {
       formElement.scrollIntoView({
         behavior: "smooth",
         block: "center"
       });
     }
   };
   ```

3. Add onClick={handleClick} to the Button.

4. Keep all existing styling (frosted glass, iOS safe area, md:hidden).

5. Ensure footer has enough bottom padding to not be covered:
   - This will be handled in page.tsx by adding pb-20 md:pb-0 to the footer section.
  </action>
  <verify>
StickyCtaBar still appears after 400px scroll on mobile.
Clicking the button smoothly scrolls to element with id="hero-form".
No visual changes to the bar styling.
  </verify>
  <done>
StickyCtaBar scrolls to hero form on click.
Maintains frosted glass effect and iOS safe area support.
  </done>
</task>

<task type="auto">
  <name>Task 3: Integrate CTAs throughout homepage</name>
  <files>website/app/page.tsx</files>
  <action>
Update `website/app/page.tsx` with strategic CTA placement:

1. Import ConversionSection from '@/components/sections/conversion/ConversionSection'

2. **Hero section** - Replace the existing CTAGroup in HeroContent with ConversionSection:
   - Actually, keep HeroContent as-is (it has CTAGroup for scroll)
   - Add ConversionSection with id="hero-form" BELOW HeroContent in the Hero section
   - Variant: "hero", showTrustText={false} (trust signal already in HeroContent)

3. **After Social Proof Counters** - Add CTA section:
   ```tsx
   <section className="py-12">
     <div className="container">
       <div className="text-center space-y-6">
         <h3 className="text-2xl font-bold">מוכן להצטרף?</h3>
         <ConversionSection variant="section" />
       </div>
     </div>
   </section>
   ```

4. **After Pricing Section** - Add prominent CTA:
   ```tsx
   <section className="py-16">
     <div className="container">
       <div className="text-center space-y-6">
         <h3 className="text-2xl font-bold">התחל היום, בחינם</h3>
         <p className="text-muted-foreground">ללא כרטיס אשראי. ללא התחייבות.</p>
         <ConversionSection variant="section" />
       </div>
     </div>
   </section>
   ```

5. **After FAQ Section** - Add final CTA before contact:
   ```tsx
   <section className="py-16 bg-muted/30">
     <div className="container">
       <div className="text-center space-y-6">
         <h3 className="text-2xl font-bold">יש לך עוד שאלות?</h3>
         <p className="text-muted-foreground">התחל בחינם או צור קשר עם הצוות שלנו</p>
         <ConversionSection variant="section" />
       </div>
     </div>
   </section>
   ```

6. **Footer area** - Keep the existing GuaranteeBadge but add padding:
   - Add pb-20 md:pb-0 to account for sticky bar on mobile

7. Update Hero component import to expose where to place the form:
   - If Hero is a wrapper component, add the ConversionSection inside it
   - OR add it right after <Hero /> in page.tsx with position that makes sense

8. Pass id="hero-form" to the first ConversionSection so StickyCtaBar can scroll to it.

9. CTA count target: 4-5 CTAs (hero form, after social proof, after pricing, after FAQ). This satisfies ACTION-01 (4-6 CTAs).

10. Keep all existing Phase 14-16 sections in place. DO NOT remove any existing sections.
  </action>
  <verify>
Homepage renders without errors.
Count CTAs: should be 4-5 ConversionSection instances.
Each CTA section has clear "what happens next" messaging.
StickyCtaBar scrolls to hero-form on click.
`npm run build` passes (or at minimum `npx tsc --noEmit`).
  </verify>
  <done>
Homepage has 4-5 strategic CTA placements.
Each CTA has social proof nearby.
StickyCtaBar scrolls to hero form.
All Phase 14-16 sections preserved.
  </done>
</task>

</tasks>

<verification>
1. ConversionSection animates smoothly between form and success states
2. StickyCtaBar scrolls to hero form
3. Homepage has 4-5 CTAs at strategic positions
4. Each CTA section has "what happens next" clarity
5. Mobile footer not covered by sticky bar
6. `npm run build` or `npx tsc --noEmit` passes
</verification>

<success_criteria>
- AnimatePresence mode="wait" provides smooth form/success transition
- CTA appears 4-5 times on homepage (ACTION-01)
- "What happens next" text below each CTA (ACTION-03)
- Social proof near every CTA (ACTION-08)
- Sticky CTA scrolls to form (MOBILE-03)
- All Phase 14-16 sections preserved
- TypeScript compiles
</success_criteria>

<output>
After completion, create `.planning/phases/17-conversion-flow/17-03-SUMMARY.md`
</output>
