---
phase: 18-emotional-journey-demo
plan: 03
type: execute
wave: 2
depends_on: ["18-02"]
files_modified:
  - website/components/sections/demo/InteractiveDemo.tsx
  - website/components/sections/demo/DemoSection.tsx
  - website/app/page.tsx
autonomous: true

must_haves:
  truths:
    - "Visitor can explore interactive product demo"
    - "Demo iframe loads only on click (not on page load)"
    - "Demo works with Hebrew RTL interface"
    - "Modal option available for full-screen experience"
  artifacts:
    - path: "website/components/sections/demo/InteractiveDemo.tsx"
      provides: "Lazy-loaded Storylane embed"
      min_lines: 60
  key_links:
    - from: "InteractiveDemo.tsx"
      to: "Storylane"
      via: "iframe embed"
      pattern: "storylane\\.io"
    - from: "DemoSection.tsx"
      to: "InteractiveDemo"
      via: "import and render"
      pattern: "import.*InteractiveDemo"
---

<objective>
Create interactive product demo integration using Storylane (or similar platform). Users can click through the actual Findo interface with guided tooltips, ending with a CTA.

Purpose: Provide hands-on exploration for visitors who want to see the product before signing up. Higher engagement than passive video, better conversion from "curious" to "convinced."

Output: InteractiveDemo component with lazy loading, integrated into DemoSection with modal option.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/18-emotional-journey-demo/18-CONTEXT.md
@.planning/phases/18-emotional-journey-demo/18-RESEARCH.md

# Demo components from 18-02
@website/components/sections/demo/LottieDemo.tsx
@website/components/sections/demo/DemoSection.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create InteractiveDemo component with lazy iframe</name>
  <files>website/components/sections/demo/InteractiveDemo.tsx</files>
  <action>
Create InteractiveDemo.tsx with click-to-load pattern:

```typescript
"use client";

import { useRef, useState } from "react";
import { useInView } from "motion/react";
import { Play, Maximize2 } from "lucide-react";
import { cn } from "@/lib/utils";
import { Button } from "@/components/ui/button";

interface InteractiveDemoProps {
  /** Storylane demo ID (from embed URL) */
  demoId: string;
  /** Poster image shown before interaction */
  poster: string;
  /** Additional CSS classes */
  className?: string;
  /** Show full-screen button */
  showFullscreen?: boolean;
}

export function InteractiveDemo({
  demoId,
  poster,
  className,
  showFullscreen = true,
}: InteractiveDemoProps) {
  const containerRef = useRef<HTMLDivElement>(null);
  const [isActivated, setIsActivated] = useState(false);
  const [isFullscreen, setIsFullscreen] = useState(false);

  // Preload iframe when 30% visible for faster activation
  const isInView = useInView(containerRef, { amount: 0.3 });

  const handleActivate = () => {
    setIsActivated(true);
  };

  const handleFullscreen = () => {
    setIsFullscreen(true);
  };

  const handleCloseFullscreen = () => {
    setIsFullscreen(false);
  };

  // Storylane embed URL with dir=rtl for Hebrew
  const embedUrl = `https://app.storylane.io/demo/${demoId}?embed=inline`;

  return (
    <>
      <div
        ref={containerRef}
        className={cn(
          "relative aspect-video rounded-2xl overflow-hidden bg-muted",
          className
        )}
      >
        {!isActivated ? (
          // Poster with play button
          <button
            onClick={handleActivate}
            className="absolute inset-0 w-full h-full group cursor-pointer"
            aria-label="Start interactive demo"
          >
            <img
              src={poster}
              alt="Interactive demo preview"
              className="w-full h-full object-cover"
            />
            <div className="absolute inset-0 bg-black/30 flex flex-col items-center justify-center gap-3 group-hover:bg-black/40 transition-colors">
              <div className="w-20 h-20 rounded-full bg-white/90 flex items-center justify-center group-hover:scale-110 transition-transform">
                <Play className="w-10 h-10 text-primary ms-1" />
              </div>
              <span className="text-white font-medium text-lg">
                לחץ לנסות בעצמך
              </span>
            </div>
          </button>
        ) : (
          // Storylane iframe
          <>
            <iframe
              src={embedUrl}
              allow="fullscreen"
              loading="lazy"
              className="absolute inset-0 w-full h-full border-none"
              title="Findo interactive demo"
            />
            {showFullscreen && (
              <Button
                variant="secondary"
                size="icon"
                onClick={handleFullscreen}
                className="absolute top-4 end-4 bg-white/90 hover:bg-white shadow-lg"
                aria-label="Open fullscreen"
              >
                <Maximize2 className="w-5 h-5" />
              </Button>
            )}
          </>
        )}
      </div>

      {/* Fullscreen modal */}
      {isFullscreen && (
        <div
          className="fixed inset-0 z-50 bg-black/80 flex items-center justify-center p-4"
          onClick={handleCloseFullscreen}
        >
          <div
            className="relative w-full max-w-6xl aspect-video rounded-xl overflow-hidden bg-background"
            onClick={(e) => e.stopPropagation()}
          >
            <iframe
              src={embedUrl}
              allow="fullscreen"
              className="w-full h-full border-none"
              title="Findo interactive demo - fullscreen"
            />
            <Button
              variant="ghost"
              size="sm"
              onClick={handleCloseFullscreen}
              className="absolute top-4 end-4 bg-white/90 hover:bg-white"
            >
              סגור
            </Button>
          </div>
        </div>
      )}
    </>
  );
}
```

Key implementation:
- Click-to-load: iframe only loads when user clicks
- Storylane URL pattern: app.storylane.io/demo/{demoId}
- Fullscreen modal for immersive experience
- RTL: end-4 for button positioning, ms-1 for icon offset
- Hebrew UI: "לחץ לנסות בעצמך" (Click to try yourself)
- Poster image shows until interaction
  </action>
  <verify>
Run: `cd website && npm run build`
- No TypeScript errors
- InteractiveDemo compiles correctly
- All props typed properly
  </verify>
  <done>
InteractiveDemo component created with lazy iframe, fullscreen modal, Hebrew UI
  </done>
</task>

<task type="auto">
  <name>Task 2: Update DemoSection with tabs for Lottie and Interactive</name>
  <files>website/components/sections/demo/DemoSection.tsx</files>
  <action>
Update DemoSection.tsx to include both demo types:

```typescript
"use client";

import { useState } from "react";
import { ScrollReveal } from "@/components/motion/ScrollReveal";
import { LottieDemo } from "./LottieDemo";
import { InteractiveDemo } from "./InteractiveDemo";
import { Button } from "@/components/ui/button";
import { cn } from "@/lib/utils";
import { Play, MousePointer } from "lucide-react";

// Import placeholder animation
import demoAnimation from "@/public/animations/demo-placeholder.json";

interface DemoSectionProps {
  className?: string;
}

type DemoTab = "video" | "interactive";

export function DemoSection({ className }: DemoSectionProps) {
  const [activeTab, setActiveTab] = useState<DemoTab>("video");

  return (
    <section className={cn("py-16 md:py-24", className)}>
      <div className="container">
        {/* Section headline */}
        <ScrollReveal className="text-center mb-8">
          <h2 className="text-3xl md:text-4xl font-bold mb-4">
            איך זה עובד? 90 שניות וזהו.
          </h2>
          <p className="text-lg text-muted-foreground max-w-2xl mx-auto">
            שיחה לא נענית → פינדו שולח ווטסאפ → לקוח מגיב → אתם מקבלים ליד חם
          </p>
        </ScrollReveal>

        {/* Tab switcher */}
        <div className="flex justify-center gap-2 mb-8">
          <Button
            variant={activeTab === "video" ? "default" : "outline"}
            onClick={() => setActiveTab("video")}
            className="gap-2"
          >
            <Play className="w-4 h-4" />
            צפה בסרטון
          </Button>
          <Button
            variant={activeTab === "interactive" ? "default" : "outline"}
            onClick={() => setActiveTab("interactive")}
            className="gap-2"
          >
            <MousePointer className="w-4 h-4" />
            נסה בעצמך
          </Button>
        </div>

        {/* Demo players */}
        <div className="max-w-4xl mx-auto">
          {activeTab === "video" ? (
            <LottieDemo
              animationData={demoAnimation}
              poster="/images/demo-poster.svg"
              className="shadow-2xl"
            />
          ) : (
            <InteractiveDemo
              demoId="PLACEHOLDER_DEMO_ID"
              poster="/images/interactive-demo-poster.svg"
              className="shadow-2xl"
            />
          )}
        </div>

        {/* Below demo CTA */}
        <ScrollReveal className="text-center mt-12">
          <p className="text-muted-foreground mb-4">
            מרשים? התחל לאסוף לידים עוד היום
          </p>
          <Button size="lg" asChild>
            <a href="#hero-form">התחל ניסיון חינם</a>
          </Button>
        </ScrollReveal>
      </div>
    </section>
  );
}
```

Changes:
- Added tab state for "video" | "interactive"
- Tab switcher buttons with icons
- Conditional rendering of LottieDemo or InteractiveDemo
- Placeholder demo ID (to be replaced with real Storylane ID)
- Hebrew labels: "צפה בסרטון" (Watch video), "נסה בעצמך" (Try yourself)

Note: Create placeholder poster for interactive demo:
- website/public/images/interactive-demo-poster.svg
  </action>
  <verify>
Run: `cd website && npm run build`
- No TypeScript errors
- Both tabs render without error
- State switching works
  </verify>
  <done>
DemoSection updated with video/interactive tabs, both demo types available
  </done>
</task>

<task type="auto">
  <name>Task 3: Integrate DemoSection into homepage</name>
  <files>website/app/page.tsx</files>
  <action>
Update page.tsx to include DemoSection:

1. Add import (direct import for SSR):
   ```typescript
   import { DemoSection } from "@/components/sections/demo/DemoSection";
   ```

2. Insert DemoSection AFTER testimonials, BEFORE video testimonial:
   - Psychological flow: Social proof -> Demo -> More proof
   - Visitors see proof, then see it in action

3. Section order update:
   ```
   1. Hero
   2. Hero Form
   3. PainPointSection
   4. Guarantee Badge
   5. Social Proof Counters
   6. ReliefSection
   7. CTA After Social Proof
   8. Testimonials Carousel
   9. Guarantee Badge
   10. DemoSection (NEW)
   11. Video Testimonial
   12. ... rest
   ```

4. Apply bg-muted/30 to DemoSection for visual rhythm:
   ```tsx
   <DemoSection className="bg-muted/30" />
   ```

5. Create placeholder poster images:
   - website/public/images/demo-poster.svg
   - website/public/images/interactive-demo-poster.svg

   Both can be simple gradient SVGs with play icon:
   ```svg
   <svg xmlns="http://www.w3.org/2000/svg" width="800" height="450" viewBox="0 0 800 450">
     <defs>
       <linearGradient id="bg" x1="0%" y1="0%" x2="100%" y2="100%">
         <stop offset="0%" style="stop-color:#f97316;stop-opacity:0.1"/>
         <stop offset="100%" style="stop-color:#f97316;stop-opacity:0.2"/>
       </linearGradient>
     </defs>
     <rect fill="url(#bg)" width="800" height="450"/>
     <circle cx="400" cy="225" r="50" fill="#f97316" opacity="0.8"/>
     <polygon points="385,200 385,250 425,225" fill="white"/>
   </svg>
   ```
  </action>
  <verify>
Run: `cd website && npm run build && npm run dev`
- Homepage loads without errors
- DemoSection visible after testimonials
- Tab switching works
- Video tab shows Lottie player
- Interactive tab shows Storylane embed (placeholder ID won't load actual demo)
- Fullscreen modal opens and closes
  </verify>
  <done>
DemoSection integrated into homepage, both demo types accessible, placeholder assets created
  </done>
</task>

</tasks>

<verification>
1. Build succeeds: `cd website && npm run build`
2. Visual check at localhost:3000:
   - DemoSection appears after testimonials
   - Tab buttons switch between video/interactive
   - Video tab: poster -> play -> animation plays
   - Interactive tab: poster -> click -> iframe loads (placeholder)
   - Fullscreen modal works for interactive demo
3. Mobile: Tabs stack if needed, demo maintains aspect ratio
4. RTL: Button icons and text aligned correctly
</verification>

<success_criteria>
- DEMO-02: Interactive demo option available (Storylane embed with placeholder ID)
- DEMO-03: Clear CTA below demo section
- DEMO-04: Demo loads fast (click-to-load pattern)
- DEMO-05: Demo works on mobile (responsive, touch-friendly)
- Tab interface allows switching between video and interactive
- Fullscreen modal available for immersive experience
</success_criteria>

<output>
After completion, create `.planning/phases/18-emotional-journey-demo/18-03-SUMMARY.md`
</output>

<user_setup>
  - service: Storylane
    why: "Interactive product demo platform"
    env_vars: []
    dashboard_config:
      - task: "Create Storylane account"
        location: "https://www.storylane.io"
      - task: "Create Findo demo walkthrough"
        location: "Storylane Dashboard -> Create Demo"
      - task: "Copy demo ID from embed URL"
        location: "Demo -> Share -> Website Embed"
      - task: "Replace PLACEHOLDER_DEMO_ID in InteractiveDemo"
        location: "website/components/sections/demo/DemoSection.tsx"
</user_setup>
