---
phase: 21-background-depth-system
plan: 02
type: execute
wave: 2
depends_on: ["21-01"]
files_modified:
  - website/app/layout.tsx
  - website/app/globals.css
autonomous: false

must_haves:
  truths:
    - "Background layers visible on website homepage"
    - "Grid pattern covers full viewport at all breakpoints"
    - "Orbs create ambient depth behind content"
    - "Noise texture adds subtle premium grain"
    - "Scroll parallax moves orbs at different speeds"
    - "Lighthouse Performance remains 95+ (desktop and mobile)"
    - "No content interaction blocked by background layers"
  artifacts:
    - path: "website/app/layout.tsx"
      provides: "BackgroundDepth integration"
      contains: "BackgroundDepth"
    - path: "website/app/globals.css"
      provides: "Background CSS variables (optional)"
  key_links:
    - from: "website/app/layout.tsx"
      to: "website/components/background/BackgroundDepth.tsx"
      via: "import and render"
      pattern: "import.*BackgroundDepth.*from"
---

<objective>
Integrate BackgroundDepth component into the website layout and verify visual appearance plus performance.

Purpose: Make background depth system visible on the live site while maintaining Lighthouse 95+ performance.
Output: Background layers active on homepage with verified performance.
</objective>

<execution_context>
@C:\Users\דודאלמועלם\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\דודאלמועלם\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/21-background-depth-system/21-RESEARCH.md
@.planning/phases/21-background-depth-system/21-01-SUMMARY.md

# Files to modify
@website/app/layout.tsx
@website/app/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Integrate BackgroundDepth into Layout</name>
  <files>website/app/layout.tsx</files>
  <action>
Add BackgroundDepth component to the root layout:

1. Import BackgroundDepth:
```typescript
import { BackgroundDepth } from "@/components/background";
```

2. Add component inside body, BEFORE children (so it's behind content):
```tsx
<body className={`${heebo.className} antialiased`}>
  <BackgroundDepth />
  <Providers>
    ...
  </Providers>
</body>
```

**Critical placement:** BackgroundDepth must be a direct child of body, OUTSIDE Providers wrapper, to ensure it's always behind page content.

3. Verify the component renders without hydration errors (it's "use client" so should work fine)
  </action>
  <verify>
1. `cd website && npm run dev` starts without errors
2. Visit http://localhost:3000 - page loads without console errors
3. Background layers visible (subtle grid, blurred orbs, noise grain)
  </verify>
  <done>
BackgroundDepth component renders in root layout behind all page content
  </done>
</task>

<task type="auto">
  <name>Task 2: Add CSS Variables for Background Tuning (Optional)</name>
  <files>website/app/globals.css</files>
  <action>
Add CSS variables to @theme block in globals.css for easy tuning of background system:

```css
/* ============================================
 * BACKGROUND DEPTH SYSTEM - Phase 21
 * Tunable variables for visual adjustments
 * ============================================ */
--bg-grid-opacity: 0.05;
--bg-orb-blur: 80px;
--bg-noise-opacity: 0.03;
--bg-noise-size: 180px;
```

Add after the existing gradient text system variables (around line 173).

**Note:** These variables are for future tuning. The component currently uses inline values from research. Variables allow adjustments without component changes later.
  </action>
  <verify>
1. CSS file saves without syntax errors
2. Dev server still running without CSS errors
  </verify>
  <done>
CSS variables defined for background depth system tuning
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete Background Depth System with:
- Subtle grid pattern overlay (5% opacity)
- Gradient orbs with blur creating ambient depth
- Noise texture overlay for premium feel
- GSAP parallax scroll animation on orbs
- Integrated into website layout
  </what-built>
  <how-to-verify>
**Visual Verification:**
1. Run `cd website && npm run dev`
2. Open http://localhost:3000 in browser
3. Check for visible background elements:
   - Subtle grid lines covering full viewport (may need to squint - it's 5% opacity)
   - Blurred orange/amber gradient blobs in background
   - Very subtle noise texture (may need to zoom in to see grain)
4. Scroll the page slowly - orbs should move at different speeds (parallax effect)
5. Resize browser window - background should work at mobile, tablet, and desktop widths
6. Click any link or button - should work (pointer-events: none on background)

**Performance Verification:**
7. Open Chrome DevTools > Lighthouse
8. Run Performance audit on Mobile
9. Verify score is 95+ (critical gate)
10. Run Performance audit on Desktop
11. Verify score is 95+ (critical gate)

**Reduced Motion Check:**
12. In browser, enable "Reduce motion" in system settings (or in DevTools Rendering tab)
13. Scroll page - parallax should NOT animate (orbs static)

**Expected Results:**
- Grid: Very subtle, barely visible lines in a 40x40 pattern
- Orbs: Soft, blurred orange/amber glow in background
- Noise: Very subtle grain texture (barely perceptible)
- Parallax: Smooth, subtle movement of orbs during scroll
- Performance: Lighthouse 95+ maintained
  </how-to-verify>
  <resume-signal>
Type "approved" if all checks pass.

If issues found, describe:
- Which element is problematic (grid/orbs/noise/parallax)
- What the issue looks like
- Browser and viewport size
  </resume-signal>
</task>

</tasks>

<verification>
After completing all tasks:
1. BackgroundDepth renders on homepage
2. All three layers visible (grid, orbs, noise)
3. Parallax animation works on scroll
4. Reduced motion preference disables parallax
5. No content interactions blocked
6. Lighthouse Performance 95+ (desktop and mobile)
</verification>

<success_criteria>
- Background depth system visibly active on website
- Premium visual appearance established
- Lighthouse Performance score 95+ maintained
- User can interact with all page elements (background doesn't block)
- Parallax respects prefers-reduced-motion
</success_criteria>

<output>
After completion, create `.planning/phases/21-background-depth-system/21-02-SUMMARY.md`
</output>
