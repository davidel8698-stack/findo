---
phase: 24-micro-interactions
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - website/app/globals.css
  - website/lib/animation.ts
autonomous: true

must_haves:
  truths:
    - "CSS keyframes for shake and error-pulse animations exist"
    - "Link underline utility classes work with RTL (slide from right in RTL)"
    - "All transitions use cubic-bezier easing variables"
    - "prefers-reduced-motion fallbacks are in place"
  artifacts:
    - path: "website/app/globals.css"
      provides: "Micro-interaction CSS foundation"
      contains: "@keyframes shake"
    - path: "website/lib/animation.ts"
      provides: "Micro-interaction timing constants"
      contains: "microInteraction"
  key_links:
    - from: "globals.css"
      to: "@theme variables"
      via: "CSS custom properties"
      pattern: "var\\(--transition"
---

<objective>
Add CSS foundation for Phase 24 micro-interactions: shake animation, error pulse, link underline utilities, and micro-interaction timing constants.

Purpose: Establish reusable CSS patterns that components will consume. Keeping this separate ensures clean separation between foundation and component implementation.

Output: globals.css extended with micro-interaction keyframes and utilities; animation.ts extended with micro-interaction timing constants.
</objective>

<execution_context>
@C:\Users\דודאלמועלם\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\דודאלמועלם\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/24-micro-interactions/24-RESEARCH.md
@website/app/globals.css
@website/lib/animation.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add micro-interaction CSS keyframes and utilities to globals.css</name>
  <files>website/app/globals.css</files>
  <action>
Add a new section "MICRO-INTERACTION SYSTEM - Phase 24" after the CTA pulse section (around line 658).

Add these keyframes and utilities:

1. **Shake animation** (MICRO-06 requirement):
   - @keyframes shake: 2px amplitude, 2 oscillations (0%, 20%, 40%, 60%, 80%, 100%)
   - Use translateX for GPU acceleration
   - Duration: 0.3s with cubic-bezier(0.36, 0.07, 0.19, 0.97) easing

2. **Error pulse animation** (MICRO-06 requirement):
   - @keyframes error-pulse: red glow that pulses (0-4px spread)
   - Use hsl(var(--destructive)) for color

3. **Error state classes** (graduated by severity per CONTEXT.md):
   - `.error-hint`: border-color only (inline validation)
   - `.error-gentle`: gentle pulse (1-2 cycles) for field validation
   - `.error-shake`: shake + glow for blocking errors

4. **Link underline utilities** (MICRO-04, RTL-06 requirements):
   - `.link-underline`: underline scales from center outward
   - Uses pseudo-element ::after with scaleX(0) -> scaleX(1)
   - Use `inset-inline-start` and `inset-inline-end` for RTL support
   - Add brightness(1.1) on hover for text
   - Transition: var(--transition-duration-200) var(--transition-timing-out)

5. **Reduced motion support**:
   - @media (prefers-reduced-motion: reduce): disable shake/pulse, use immediate opacity changes
   - For links: show underline at 50% opacity always (no animation)

6. **Touch device handling**:
   - @media (hover: none): show link underline at 50% opacity (no hover state)

IMPORTANT:
- All animations must use transform/opacity only (GPU-accelerated)
- Use existing CSS variables (--transition-duration-*, --transition-timing-*)
- Keep existing code intact, only add new section
  </action>
  <verify>
Run: `grep -n "shake\|error-pulse\|link-underline" website/app/globals.css`
Should show new keyframes and utility classes.
  </verify>
  <done>
globals.css contains:
- @keyframes shake with 2px translateX amplitude
- @keyframes error-pulse with destructive color glow
- .error-hint, .error-gentle, .error-shake classes
- .link-underline utility with RTL-aware positioning
- prefers-reduced-motion fallbacks
- hover: none fallbacks
  </done>
</task>

<task type="auto">
  <name>Task 2: Add micro-interaction timing constants to animation.ts</name>
  <files>website/lib/animation.ts</files>
  <action>
Add micro-interaction specific constants to animation.ts after the existing exports.

Add:

1. **microInteraction object** for snappy button/card interactions:
```typescript
/**
 * MICRO-INTERACTION CONFIG - Phase 24
 * Snappy & precise feel (150-200ms per CONTEXT.md)
 * For button hover, card lift, link underlines
 */
export const microInteraction = {
  duration: 0.15, // 150ms - fast and snappy
  ease: [0, 0, 0.2, 1], // ease-out cubic-bezier
};
```

2. **shadowLiftHover object** for button shadow-lift behavior:
```typescript
/**
 * Shadow-lift hover effect for buttons
 * Primary effect per CONTEXT.md: translateY + shadow increase, NOT scale
 */
export const shadowLiftHover = {
  y: -1,
  boxShadow: "var(--shadow-hover)",
};
```

3. **shadowLiftTap object** for button press:
```typescript
/**
 * Press/tap feedback for buttons
 * Scale down + reduced shadow
 */
export const shadowLiftTap = {
  scale: 0.98,
  boxShadow: "var(--shadow-elevation-medium)",
};
```

4. **cardLiftHover object** (verify AnimatedCard uses same values):
```typescript
/**
 * Card lift on hover
 * Already implemented in card.tsx, exported for consistency
 */
export const cardLiftHover = {
  y: -4,
  boxShadow: "var(--shadow-hover)",
};
```

Keep all existing code. Add after the easing export (around line 90).
  </action>
  <verify>
Run: `grep -n "microInteraction\|shadowLiftHover\|shadowLiftTap\|cardLiftHover" website/lib/animation.ts`
Should show all four new exports.
  </verify>
  <done>
animation.ts exports:
- microInteraction with 0.15s duration and ease-out
- shadowLiftHover with y: -1 and shadow-hover
- shadowLiftTap with scale: 0.98 and shadow-elevation-medium
- cardLiftHover with y: -4 and shadow-hover
  </done>
</task>

</tasks>

<verification>
1. globals.css has new micro-interaction section with keyframes and utilities
2. animation.ts has new micro-interaction constants
3. No TypeScript errors: `cd website && npx tsc --noEmit`
4. No breaking changes to existing code
</verification>

<success_criteria>
- Shake animation keyframe exists with 2px amplitude, 2 oscillations
- Error pulse keyframe exists with destructive color
- Link underline utilities exist with RTL support (inset-inline-start/end)
- All new transitions use cubic-bezier easing (MICRO-07)
- prefers-reduced-motion fallbacks present
- animation.ts exports microInteraction, shadowLiftHover, shadowLiftTap, cardLiftHover
</success_criteria>

<output>
After completion, create `.planning/phases/24-micro-interactions/24-01-SUMMARY.md`
</output>
