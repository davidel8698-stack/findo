---
phase: 24-micro-interactions
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - website/components/ui/button.tsx
  - website/components/ui/input.tsx
  - website/components/molecules/FormField.tsx
  - website/lib/hooks/useShake.ts
autonomous: true

must_haves:
  truths:
    - "Buttons use shadow-lift on hover (y: -1, shadow increase), NOT scale"
    - "Buttons scale 0.98 on press with reduced shadow"
    - "Disabled buttons have no hover effect"
    - "Input fields have focus glow with 4px spread"
    - "Error inputs can trigger shake animation"
    - "All transitions are 150-200ms with cubic-bezier easing"
  artifacts:
    - path: "website/components/ui/button.tsx"
      provides: "AnimatedButton with shadow-lift hover"
      contains: "shadowLiftHover"
    - path: "website/components/ui/input.tsx"
      provides: "Input with error prop and focus glow"
      contains: "error"
    - path: "website/lib/hooks/useShake.ts"
      provides: "Hook for triggering shake animation"
      exports: ["useShake"]
  key_links:
    - from: "button.tsx"
      to: "animation.ts"
      via: "import"
      pattern: "import.*microInteraction"
    - from: "FormField.tsx"
      to: "useShake.ts"
      via: "import"
      pattern: "import.*useShake"
---

<objective>
Enhance button and input components with Phase 24 micro-interactions: shadow-lift hover for buttons, error shake for inputs.

Purpose: Make interactive elements feel snappy and responsive per CONTEXT.md "snappy & precise feel". This satisfies MICRO-01 (button hover glow), MICRO-02 (button press), MICRO-05 (input focus glow), MICRO-06 (error shake).

Output: Updated button.tsx with shadow-lift behavior, updated input.tsx with error states, new useShake hook.
</objective>

<execution_context>
@C:\Users\דודאלמועלם\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\דודאלמועלם\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/24-micro-interactions/24-RESEARCH.md
@.planning/phases/24-micro-interactions/24-CONTEXT.md
@website/components/ui/button.tsx
@website/components/ui/input.tsx
@website/components/molecules/FormField.tsx
@website/lib/animation.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update AnimatedButton with shadow-lift hover behavior</name>
  <files>website/components/ui/button.tsx</files>
  <action>
Update the AnimatedButton component to use shadow-lift on hover instead of scale (per CONTEXT.md decision).

Changes:

1. Import new constants from animation.ts:
```typescript
import { springBouncy, microInteraction, shadowLiftHover, shadowLiftTap } from "@/lib/animation";
```

2. Update AnimatedButton whileHover/whileTap:
- Remove current `whileHover={{ scale: 1.02 }}`
- Add logic to disable hover/tap for disabled buttons
- Use microInteraction transition instead of springBouncy

Replace the AnimatedButton implementation with:
```typescript
const AnimatedButton = React.forwardRef<HTMLButtonElement, AnimatedButtonProps>(
  ({ className, variant, size, glow, loading = false, children, ...props }, ref) => {
    const isDisabled = loading || props.disabled;

    return (
      <m.button
        ref={ref}
        className={cn(
          buttonVariants({ variant, size, glow, loading, className }),
          isDisabled && "cursor-not-allowed"
        )}
        disabled={isDisabled}
        // Shadow-lift on hover (not scale for standard buttons per CONTEXT.md)
        whileHover={isDisabled ? {} : shadowLiftHover}
        // Press: scale down + reduce shadow
        whileTap={isDisabled ? {} : shadowLiftTap}
        // Snappy 150ms transition
        transition={microInteraction}
        {...props}
      >
        {children}
      </m.button>
    );
  }
);
```

3. Add new HeroCTAButton variant that CAN use scale (per CONTEXT.md exception for hero CTA):
```typescript
/**
 * Hero CTA Button - special variant with scale + glow intensification
 * Only for hero primary CTA where scale is acceptable
 */
export interface HeroCTAButtonProps extends AnimatedButtonProps {
  /** Intensify glow on hover (default: true) */
  intensifyGlow?: boolean;
}

const HeroCTAButton = React.forwardRef<HTMLButtonElement, HeroCTAButtonProps>(
  ({ className, intensifyGlow = true, children, ...props }, ref) => {
    const isDisabled = props.loading || props.disabled;

    return (
      <m.button
        ref={ref}
        className={cn(
          buttonVariants({ variant: "default", size: "lg", glow: "cta", className }),
          isDisabled && "cursor-not-allowed"
        )}
        disabled={isDisabled}
        whileHover={isDisabled ? {} : {
          scale: 1.02,
          y: -1,
          // Intensify glow: +8px spread, +0.1 opacity per CONTEXT.md
          boxShadow: intensifyGlow
            ? "0 0 25px 10px hsl(24.6 95% 53.1% / 0.3), var(--shadow-cta)"
            : shadowLiftHover.boxShadow,
        }}
        whileTap={isDisabled ? {} : shadowLiftTap}
        transition={microInteraction}
        {...props}
      >
        {children}
      </m.button>
    );
  }
);
HeroCTAButton.displayName = "HeroCTAButton";
```

4. Export HeroCTAButton:
```typescript
export { Button, AnimatedButton, HeroCTAButton, buttonVariants };
```

IMPORTANT:
- Keep the existing Button component unchanged (it's for non-animated use cases)
- Disabled buttons must have NO hover effect (whileHover: {} when disabled)
  </action>
  <verify>
Run: `grep -n "shadowLiftHover\|shadowLiftTap\|microInteraction\|HeroCTAButton" website/components/ui/button.tsx`
Should show imports and usage of new constants plus HeroCTAButton.
  </verify>
  <done>
button.tsx:
- AnimatedButton uses shadowLiftHover (y: -1, shadow) instead of scale
- AnimatedButton uses shadowLiftTap (scale: 0.98) on press
- Disabled state has no hover/tap animations
- HeroCTAButton exported with scale exception for hero
- microInteraction transition (150ms) used
  </done>
</task>

<task type="auto">
  <name>Task 2: Create useShake hook for error animation</name>
  <files>website/lib/hooks/useShake.ts</files>
  <action>
Create a new hook for triggering shake animations with severity levels.

Create file: website/lib/hooks/useShake.ts

```typescript
"use client";

import { useCallback, useRef } from "react";

type ShakeSeverity = "hint" | "gentle" | "blocking";

/**
 * Hook for triggering shake/error animations on form elements
 *
 * Severity levels (per CONTEXT.md):
 * - hint: color change only (user already focused)
 * - gentle: pulse animation (1-2 cycles)
 * - blocking: shake + glow (payment failed, auth errors)
 *
 * @example
 * const { ref, triggerShake } = useShake<HTMLInputElement>();
 * // On error:
 * triggerShake("gentle");
 */
export function useShake<T extends HTMLElement>() {
  const ref = useRef<T>(null);

  const triggerShake = useCallback((severity: ShakeSeverity = "gentle") => {
    const element = ref.current;
    if (!element) return;

    // Remove any existing error classes
    element.classList.remove("error-hint", "error-gentle", "error-shake");

    // Force reflow to restart animation if same class applied again
    void element.offsetWidth;

    // Apply severity-appropriate class
    const className =
      severity === "hint"
        ? "error-hint"
        : severity === "blocking"
          ? "error-shake"
          : "error-gentle";

    element.classList.add(className);

    // Clean up after animation completes
    const cleanup = () => {
      // Keep error-hint (it's not animated, just styling)
      if (severity !== "hint") {
        element.classList.remove(className);
      }
      element.removeEventListener("animationend", cleanup);
    };

    if (severity !== "hint") {
      element.addEventListener("animationend", cleanup);
    }
  }, []);

  const clearError = useCallback(() => {
    const element = ref.current;
    if (!element) return;
    element.classList.remove("error-hint", "error-gentle", "error-shake");
  }, []);

  return { ref, triggerShake, clearError };
}
```

Also create the hooks directory if it doesn't exist.
  </action>
  <verify>
Run: `cat website/lib/hooks/useShake.ts | head -20`
Should show the hook implementation.
  </verify>
  <done>
useShake hook:
- Returns ref, triggerShake, clearError
- triggerShake accepts severity: "hint" | "gentle" | "blocking"
- Forces reflow for animation restart
- Cleans up animation classes after completion
  </done>
</task>

<task type="auto">
  <name>Task 3: Enhance Input component with error prop and focus glow</name>
  <files>website/components/ui/input.tsx</files>
  <action>
Update Input component to accept an error prop and enhance focus glow.

Changes:

1. Add error prop to interface:
```typescript
interface InputProps extends React.ComponentProps<"input"> {
  /** Error state - adds destructive border and glow */
  error?: boolean;
}
```

2. Update Input component to use error prop:
```typescript
const Input = React.forwardRef<HTMLInputElement, InputProps>(
  ({ className, type, error, ...props }, ref) => {
    return (
      <input
        type={type}
        className={cn(
          "flex h-12 w-full rounded-lg border border-input bg-background px-4 py-3 text-base text-start ring-offset-background",
          "file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground",
          "placeholder:text-muted-foreground",
          "disabled:cursor-not-allowed disabled:opacity-50",
          // Focus glow with 4px spread (MICRO-05)
          "focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",
          "focus-visible:shadow-[0_0_0_4px_hsl(var(--ring)_/_0.15)]",
          // Transition for smooth glow animation (MICRO-07, MICRO-08)
          "transition-[box-shadow,border-color] duration-200 ease-out",
          // Error state styling
          error && [
            "border-destructive",
            "focus-visible:ring-destructive",
            "focus-visible:shadow-[0_0_0_4px_hsl(var(--destructive)_/_0.15)]",
          ],
          className
        )}
        aria-invalid={error || undefined}
        ref={ref}
        {...props}
      />
    );
  }
);
```

3. Export the InputProps interface for reuse:
```typescript
export { Input, type InputProps };
```

IMPORTANT:
- Focus glow uses box-shadow with 4px spread per MICRO-05
- Transition duration is 200ms with ease-out per MICRO-07/MICRO-08
- Error state changes border, ring, and shadow color to destructive
  </action>
  <verify>
Run: `grep -n "error\|4px" website/components/ui/input.tsx`
Should show error prop and 4px spread in focus shadow.
  </verify>
  <done>
Input component:
- Has error prop for destructive styling
- Focus glow has 4px spread (MICRO-05)
- Transition is 200ms with ease-out (MICRO-07, MICRO-08)
- Error state uses destructive colors
- aria-invalid set when error is true
  </done>
</task>

</tasks>

<verification>
1. AnimatedButton uses shadow-lift hover (y: -1, not scale): `grep -A5 "whileHover" website/components/ui/button.tsx`
2. HeroCTAButton exists with scale exception: `grep "HeroCTAButton" website/components/ui/button.tsx`
3. useShake hook exists: `cat website/lib/hooks/useShake.ts`
4. Input has error prop: `grep "error" website/components/ui/input.tsx`
5. No TypeScript errors: `cd website && npx tsc --noEmit`
</verification>

<success_criteria>
- AnimatedButton whileHover uses y: -1 + shadow-hover (NOT scale) - MICRO-01 partially (glow via glow variants)
- AnimatedButton whileTap uses scale: 0.98 + shadow-elevation-medium - MICRO-02
- HeroCTAButton exists with scale: 1.02 exception for hero CTA
- Disabled buttons have whileHover: {} (no animation)
- Input has error prop triggering destructive border/glow
- Focus glow uses 4px spread - MICRO-05
- All transitions use cubic-bezier (ease-out) - MICRO-07
- All transitions are 150-200ms - MICRO-08
- useShake hook exists with severity levels
</success_criteria>

<output>
After completion, create `.planning/phases/24-micro-interactions/24-02-SUMMARY.md`
</output>
