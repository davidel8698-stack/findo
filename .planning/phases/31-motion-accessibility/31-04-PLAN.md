---
phase: 31-motion-accessibility
plan: 04
type: execute
wave: 2
depends_on: ["31-01", "31-02", "31-03"]
files_modified:
  - website/app/globals.css
  - website/components/motion/variants.ts
  - website/lib/animation.ts
autonomous: true

must_haves:
  truths:
    - "Link underline animation uses scaleX with transform-origin center"
    - "All animations use only GPU-accelerated properties (transform, opacity)"
    - "Motion variants have reduced motion alternatives"
    - "Hover animations use 150-200ms timing"
  artifacts:
    - path: "website/app/globals.css"
      provides: "Link underline with scaleX and CSS variable duration"
      contains: [".link-underline::after", "transform: scaleX", "var(--duration-hover)"]
    - path: "website/components/motion/variants.ts"
      provides: "Updated variants using CSS duration tokens"
      contains: ["cssDuration", "reducedMotionFade"]
  key_links:
    - from: "website/components/motion/variants.ts"
      to: "website/lib/animation.ts"
      via: "Import cssDuration"
      pattern: "import.*cssDuration"
---

<objective>
Audit and standardize all animations for timing, GPU-acceleration, and reduced motion.

Purpose: Ensure all animations follow "motion felt, not seen" (MOTION-06), link underlines use proper animation (MOTION-07), and only GPU properties are used (MOTION-08).
Output: Standardized animation timing, link underline fix, variants update
</objective>

<execution_context>
@C:\Users\דודאלמועלם\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\דודאלמועלם\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/31-motion-accessibility/31-RESEARCH.md
@.planning/phases/31-motion-accessibility/31-CONTEXT.md
@.planning/phases/31-motion-accessibility/31-01-SUMMARY.md
@website/app/globals.css
@website/components/motion/variants.ts
@website/lib/animation.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update link underline animation (MOTION-07)</name>
  <files>website/app/globals.css</files>
  <action>
Find and update the existing .link-underline animation to use:
- CSS variable duration (var(--duration-hover))
- CSS variable easing (var(--ease-quick-press))
- transform-origin: center (per MOTION-07 spec)

Search for ".link-underline" in globals.css and update to:
```css
/* Link underline animation - MOTION-07 */
.link-underline {
  position: relative;
}

.link-underline::after {
  content: "";
  position: absolute;
  inset-inline-start: 0;
  inset-inline-end: 0;
  bottom: 0;
  height: 1px;
  background-color: currentColor;
  transform: scaleX(0);
  transform-origin: center; /* Scale from center per MOTION-07 */
  transition: transform var(--duration-hover, 150ms) var(--ease-quick-press, cubic-bezier(0, 0, 0.2, 1));
}

.link-underline:hover::after,
.link-underline:focus-visible::after {
  transform: scaleX(1);
}
```

Key requirements:
- Uses scaleX (GPU-accelerated, not width)
- transform-origin: center (scales from middle)
- Uses CSS variable tokens with fallbacks
- Added :focus-visible for keyboard accessibility
  </action>
  <verify>
Check origin: `grep "transform-origin: center" website/app/globals.css`
Check duration: `grep "var(--duration-hover" website/app/globals.css`
  </verify>
  <done>
Link underline uses scaleX with center transform-origin and CSS variable timing.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update motion variants to use standardized timing</name>
  <files>website/components/motion/variants.ts</files>
  <action>
Update variants.ts to import and use the new CSS duration constants for consistency.

1. Update imports at top to include cssDuration:
```typescript
import { Variants } from "motion/react";
import { springBouncy, springGentle, stagger, fastStagger, cssDuration } from "@/lib/animation";
```

2. Update reducedMotionFade to use cssDuration.hover:
```typescript
/**
 * Reduced motion fallback - opacity only, 150ms
 * Per CONTEXT.md accessibility requirements
 */
export const reducedMotionFade: Variants = {
  hidden: { opacity: 0 },
  visible: {
    opacity: 1,
    transition: { duration: cssDuration.hover }, // 150ms from token
  },
};
```

3. Add a new variant for standardized hover transitions:
```typescript
/**
 * Standard hover transition - 150-200ms per MOTION-02
 * Use for micro-interactions (buttons, cards, links)
 */
export const hoverTransition = {
  type: "tween" as const,
  duration: cssDuration.hover,
  ease: [0.34, 1.56, 0.64, 1] as const, // bouncy
};

/**
 * Standard reveal transition - 400ms per MOTION-03
 * Use for scroll-triggered section reveals
 */
export const revealTransition = {
  type: "tween" as const,
  duration: cssDuration.reveal,
  ease: [0.33, 1, 0.68, 1] as const, // standard
};
```

Do NOT remove or break any existing variants. Add/update as specified.
  </action>
  <verify>
Import check: `grep "cssDuration" website/components/motion/variants.ts`
Hover transition: `grep "hoverTransition" website/components/motion/variants.ts`
TypeScript: `npx tsc --noEmit website/components/motion/variants.ts` should pass
  </verify>
  <done>
Variants use cssDuration tokens. New hoverTransition and revealTransition exported.
  </done>
</task>

<task type="auto">
  <name>Task 3: Audit and document GPU-only animation properties</name>
  <files>website/lib/animation.ts</files>
  <action>
Add a documentation comment at the top of animation.ts documenting the GPU-only property rule (MOTION-08).

Update the existing file header comment to include:
```typescript
/**
 * Animation constants and spring presets for Findo
 * Playful & delightful character per CONTEXT.md
 *
 * PERFORMANCE OPTIMIZATIONS (Phase 19):
 * - GPU-optimized springs for 60fps performance
 * - Only animate transform and opacity (compositor-only)
 * - will-change hints for GPU acceleration
 *
 * MOTION-08 RULE (Phase 31):
 * All animations MUST use GPU-accelerated properties ONLY:
 * ✓ ALLOWED: transform (translate, scale, rotate), opacity
 * ✗ FORBIDDEN: width, height, margin, padding, top, left, right, bottom
 *
 * This ensures 60fps performance without layout thrashing.
 * Violations cause jank and battery drain.
 */
```

This documents the existing rule (from Phase 19) and reinforces it for Phase 31.
  </action>
  <verify>
Check header: `head -20 website/lib/animation.ts | grep "MOTION-08"`
Check rule doc: `grep "GPU-accelerated" website/lib/animation.ts`
  </verify>
  <done>
animation.ts header documents MOTION-08 GPU-only property rule.
  </done>
</task>

</tasks>

<verification>
1. Link underline works: Hover over footer links, underline should expand from center
2. Variants build: `cd website && npm run build` passes without errors
3. GPU rule documented: MOTION-08 rule visible in animation.ts header
4. Timing consistent: reducedMotionFade uses 150ms (cssDuration.hover)
</verification>

<success_criteria>
- [ ] .link-underline uses scaleX with transform-origin: center
- [ ] .link-underline uses CSS variable tokens
- [ ] variants.ts imports and uses cssDuration
- [ ] hoverTransition and revealTransition exports added
- [ ] animation.ts header documents MOTION-08 GPU rule
- [ ] Build passes with no errors
</success_criteria>

<output>
After completion, create `.planning/phases/31-motion-accessibility/31-04-SUMMARY.md`
</output>
