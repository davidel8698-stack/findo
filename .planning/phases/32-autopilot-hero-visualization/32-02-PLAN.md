---
phase: 32-autopilot-hero-visualization
plan: 02
type: execute
wave: 2
depends_on: ["32-01"]
files_modified:
  - website/components/sections/autopilot-hero/AutopilotPanels.tsx
  - website/components/sections/autopilot-hero/usePeriodicUpdates.ts
  - website/components/sections/autopilot-hero/ReviewsPanel.tsx
  - website/components/sections/autopilot-hero/LeadsPanel.tsx
  - website/components/sections/autopilot-hero/ActivityPanel.tsx
  - website/components/sections/hero/Hero.tsx
  - website/app/page.tsx
autonomous: false

must_haves:
  truths:
    - "Panels entrance-animate with staggered fade-up + scale when hero completes"
    - "Numbers (rating, lead count) count up to final values on entrance"
    - "Periodic live updates cycle new items into each panel list every 5-7 seconds"
    - "After 3-4 update cycles, panels pause for 30 seconds before resuming"
    - "All animations respect prefers-reduced-motion"
    - "Autopilot panels are integrated into Hero section and visible on the homepage"
    - "Story 'Findo runs your business while you sleep' communicated through live-updating panels"
  artifacts:
    - path: "website/components/sections/autopilot-hero/usePeriodicUpdates.ts"
      provides: "Custom hook for timed item cycling with pause behavior"
      min_lines: 40
    - path: "website/components/sections/autopilot-hero/AutopilotPanels.tsx"
      provides: "Updated container with entrance animation orchestration"
      min_lines: 60
    - path: "website/components/sections/hero/Hero.tsx"
      provides: "Updated hero with AutopilotPanels integrated below grid"
      min_lines: 80
    - path: "website/app/page.tsx"
      provides: "Updated page with placeholder comment removed"
      min_lines: 100
  key_links:
    - from: "AutopilotPanels.tsx"
      to: "hero-entrance-complete event"
      via: "window.addEventListener for hero entrance sync"
      pattern: "hero-entrance-complete"
    - from: "ReviewsPanel.tsx, LeadsPanel.tsx, ActivityPanel.tsx"
      to: "usePeriodicUpdates.ts"
      via: "hook for periodic item cycling"
      pattern: "usePeriodicUpdates"
    - from: "ReviewsPanel.tsx, LeadsPanel.tsx, ActivityPanel.tsx"
      to: "motion/react"
      via: "AnimatePresence for item enter/exit animations"
      pattern: "AnimatePresence"
    - from: "Hero.tsx"
      to: "AutopilotPanels.tsx"
      via: "imports and renders panels inside hero section"
      pattern: "AutopilotPanels"
---

<objective>
Add all animations to the Autopilot Hero panels and integrate them into the Hero section of the homepage. This plan transforms the static panels from Plan 32-01 into a living, breathing visualization that tells the story "Findo runs your business while you sleep" through entrance animations, count-up numbers, and periodic live updates.

Purpose: Complete the Phase 32 visualization by adding the motion layer (entrance, continuous, periodic) and placing the panels in their final position inside the Hero section. Follows CONTEXT.md: "Plan 3: Animations + shimmer + periodic updates + RTL check."

Output: Panels animate into view with stagger, numbers count up, list items periodically cycle in/out, and the full component is integrated into Hero.tsx above the hero form.
</objective>

<execution_context>
@C:\Users\דודאלמועלם\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\דודאלמועלם\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/32-autopilot-hero-visualization/32-CONTEXT.md
@.planning/phases/32-autopilot-hero-visualization/32-RESEARCH.md
@.planning/phases/32-autopilot-hero-visualization/32-01-SUMMARY.md
@design-bible/LINEAR-BLUEPRINT.md
@website/components/sections/hero/Hero.tsx
@website/components/sections/autopilot-hero/AutopilotPanels.tsx
@website/components/sections/autopilot-hero/ReviewsPanel.tsx
@website/components/sections/autopilot-hero/LeadsPanel.tsx
@website/components/sections/autopilot-hero/ActivityPanel.tsx
@website/components/sections/autopilot-hero/panelData.ts
@website/lib/animation.ts
@website/components/motion/variants.ts

Reference screenshots (read with Read tool for final visual comparison):
- Screenshots of the linear website/01-hero-floating-ui-panels.png
- Screenshots of the linear website/05-timeline-3d-visualization.png
</context>

<visual_specifications>

## Entrance Animation (0-2s, synced with hero completion)

### Trigger
- Wait for `hero-entrance-complete` custom event (dispatched by Hero.tsx at ~1000ms)
- Fallback: auto-trigger after 2000ms if event never fires
- On reduced motion: show panels immediately (no animation)

### Panel Entrance (Motion variants)
- Container variant: `staggerChildren: 0.15` (150ms stagger)
- Each panel:
  - `initial`: `{ opacity: 0, y: 20, scale: 0.95 }`
  - `animate`: `{ opacity: 1, y: 0, scale: 1 }`
  - `transition`: `{ duration: 0.3, ease: cssEasing.standard }` (300ms, standard easing)
- Stagger order: Reviews first (front), then Leads (middle), then Activity (back)
- Mobile: same stagger but without scale (just fade-up)

### Count-Up Numbers (entrance only)
- Rating: spring from 4.5 to 4.8 (1 decimal)
- Use `useSpring` + `useTransform` + `useInView` pattern from SocialProofCounters.tsx
- Spring config: `stiffness: 100, damping: 30, restDelta: 0.001`
- Trigger: when panel enters viewport (once)
- Display: `tabular-nums` class for stable width during animation

## Continuous Animations (always running)

### Pulsing Green Dot
- Already implemented via CSS keyframe in Plan 32-01
- `pulse-dot`: opacity 0.6 -> 1 -> 0.6, 2s infinite
- Auto-disabled by prefers-reduced-motion rule

### Shimmer Border
- Already applied on Reviews panel via `shimmer-border` class from Plan 32-01
- Existing CSS handles the sweep animation

## Periodic Live Updates (every 5-7s)

### usePeriodicUpdates Hook
- Config: `{ items, visibleCount, intervalMs, maxCycles, pauseMs }`
- Returns: `{ visibleItems, isUpdating }`
- Behavior:
  1. Shows first `visibleCount` items initially
  2. Every `intervalMs` (5000-7000ms): prepend next item from pool, remove last
  3. After `maxCycles` (3-4): pause for `pauseMs` (30000ms)
  4. After pause: reset cycle count, resume
  5. Items cycle through pool using modular index
- Reduced motion: returns static items, no cycling
- Cleanup: all timers cleared on unmount via useRef + useEffect cleanup
- SSR safe: no window/timer access during SSR

### Per-Panel Update Config
- **Activity** updates at base interval (~5000ms)
- **Leads** updates 2s after Activity (~7000ms offset via initialDelay)
- **Reviews** updates 2s after Leads (~9000ms offset)
- This creates a wave effect across panels and spreads GPU load

### AnimatePresence for Item Cycling
- Wrap list items in `<AnimatePresence initial={false} mode="popLayout">`
- Each item is `<m.div>` with:
  - `key={item.id}` (stable unique key for tracking)
  - `layout` prop (GPU-accelerated position transitions)
  - `initial={{ opacity: 0, y: -24, scale: 0.95 }}`
  - `animate={{ opacity: 1, y: 0, scale: 1 }}`
  - `exit={{ opacity: 0, scale: 0.95 }}`
  - `transition={{ opacity: { duration: 0.2 }, layout: { duration: 0.3, ease: cssEasing.standard }, scale: { duration: 0.2 } }}`
- `mode="popLayout"`: exits don't block entries, prevents layout jumps
- `initial={false}`: no entrance animation on first render (items are already there)

## Hero Integration

### Placement
- AutopilotPanels renders INSIDE `<Hero>` component
- Position: full-width row below the existing 2-column grid (HeroContent + PhoneMockup)
- Hero structure becomes:
  ```
  <section> (hero)
    <div class="container">
      <div class="grid lg:grid-cols-2"> (existing)
        <HeroContent />
        <PhoneMockup />
      </div>
      <div class="mt-12 lg:mt-16"> (NEW)
        <AutopilotPanels />
      </div>
    </div>
  </section>
  ```

### Hero Adjustments
- Remove `min-h-[100dvh]` and replace with `min-h-[100vh] lg:min-h-auto lg:py-section-hero` — on desktop, let hero grow naturally with panels; on mobile keep full-viewport hero
- OR keep `min-h-[100dvh]` and let hero expand beyond viewport (panels below fold invite scroll) — this is the simpler approach, try this first
- Remove `items-center` from hero flex (prevents vertical centering when content is tall)
- Replace with `items-start pt-24 lg:pt-32` for top-aligned content with generous top padding
- The panels will be below the fold on desktop, inviting scroll — this is intentional per "above the fold" context (the panels START above the fold's bottom edge, extending below)

### page.tsx Updates
- Remove the Phase 32 placeholder comment
- No other changes needed (AutopilotPanels is inside Hero, not in page.tsx)

## Animation Performance

### GPU-Only Properties
- All animations use ONLY: transform (translate, scale), opacity
- layout prop uses GPU-accelerated FLIP animation
- No width/height/margin/padding animation per MOTION-08 rule

### Performance Budget
- 1 shimmer (Reviews only) — CSS animation
- 3 pulsing dots — CSS animation (opacity only)
- Periodic updates staggered ~2s apart (never simultaneous)
- Count-up is one-time (useInView once: true)
- Entrance animation completes in <2s, then only periodic updates remain

## Reference Screenshots
- **01-hero-floating-ui-panels.png**: Final placement context — panels should feel like they belong in the hero area, adding visual weight and credibility
- **05-timeline-3d-visualization.png**: Animation quality reference — the 3D elements should feel smooth and intentional, not janky

</visual_specifications>

<tasks>

<task type="auto">
  <name>Task 1: Create usePeriodicUpdates hook and add animations to panel components</name>
  <files>
    website/components/sections/autopilot-hero/usePeriodicUpdates.ts
    website/components/sections/autopilot-hero/ReviewsPanel.tsx
    website/components/sections/autopilot-hero/LeadsPanel.tsx
    website/components/sections/autopilot-hero/ActivityPanel.tsx
  </files>
  <action>
    1. **usePeriodicUpdates.ts**: Create the custom hook for periodic item cycling.
       - Interface `PeriodicUpdateConfig { items: T[], visibleCount: number, intervalMs: number, maxCycles: number, pauseMs: number, initialDelay?: number }`
       - Generic over item type `T extends { id: string }`
       - State: `visibleItems` (array), `nextIndex` (number), `cycleCount` (number), `isPaused` (boolean)
       - Initialize `visibleItems` with first `visibleCount` items, `nextIndex` with `visibleCount`
       - Use `useReducedMotion()` from `motion/react` — if true, return static items immediately
       - Use `useRef<ReturnType<typeof setTimeout> | null>` for timer cleanup
       - In useEffect:
         - If `initialDelay > 0` and first run: wait initialDelay before starting
         - If paused: set timeout for `pauseMs`, then reset cycleCount and unpause
         - If not paused: set interval for `intervalMs`. On each tick: prepend next item (wrapping via modulus), remove last item, increment cycleCount. If cycleCount >= maxCycles: pause
       - Return cleanup in useEffect that clears timer
       - Return `{ visibleItems, isUpdating: !isPaused }`
       - Handle component unmount safely (check if component is still mounted before setState)

    2. **Update ReviewsPanel.tsx**: Add periodic updates and count-up animation.
       - Import `usePeriodicUpdates`, `AnimatePresence`, `m` from motion/react, `useSpring`, `useTransform`, `useInView` from motion/react, `cssEasing` from animation.ts
       - Add count-up for rating: `useSpring(4.5, { stiffness: 100, damping: 30 })` + `useTransform` to format with 1 decimal. Trigger with `useInView` (once: true). Display as `<m.span className="tabular-nums">`
       - Add `usePeriodicUpdates` with config: items=reviewItems (full pool), visibleCount=5, intervalMs=6500, maxCycles=3, pauseMs=30000, initialDelay=9000 (updates after Activity and Leads)
       - Wrap review items in `<AnimatePresence initial={false} mode="popLayout">` with `<m.div key={item.id} layout initial/animate/exit` per visual specs
       - Keep body overflow-hidden with max-height

    3. **Update LeadsPanel.tsx**: Add periodic updates.
       - Import same motion utilities
       - Add `usePeriodicUpdates`: items=leadItems, visibleCount=5, intervalMs=6000, maxCycles=3, pauseMs=30000, initialDelay=7000
       - Wrap lead items in AnimatePresence with m.div per visual specs
       - Keep body overflow-hidden with max-height

    4. **Update ActivityPanel.tsx**: Add periodic updates.
       - Import same motion utilities
       - Add `usePeriodicUpdates`: items=activityItems, visibleCount=5, intervalMs=5500, maxCycles=4, pauseMs=30000, initialDelay=5000 (first to update)
       - Wrap activity items in AnimatePresence with m.div per visual specs
       - Keep body overflow-hidden with max-height

    **RTL Check:** AnimatePresence animations use `y` (vertical), not `x` (horizontal) — direction-agnostic. Layout animations are GPU-accelerated FLIP — also direction-agnostic.

    **Reduced Motion:** usePeriodicUpdates returns static items when reduced motion is preferred. AnimatePresence still works (items just don't animate).
  </action>
  <verify>
    - TypeScript compiles: `cd website && npx tsc --noEmit`
    - usePeriodicUpdates.ts exists with correct generic signature
    - All 3 panels import and use usePeriodicUpdates with different initialDelay values
    - All 3 panels use AnimatePresence with mode="popLayout"
    - ReviewsPanel uses useSpring for count-up animation
    - grep for "useReducedMotion" in usePeriodicUpdates confirms reduced motion handling
  </verify>
  <done>
    usePeriodicUpdates hook created with timer management, pause/resume, and reduced motion support. All 3 panels have periodic item cycling with staggered timing (Activity 5s, Leads 7s, Reviews 9s). ReviewsPanel has count-up animation for the 4.8 rating. All animations use AnimatePresence with popLayout mode and GPU-only properties.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add entrance animation to AutopilotPanels and integrate into Hero</name>
  <files>
    website/components/sections/autopilot-hero/AutopilotPanels.tsx
    website/components/sections/hero/Hero.tsx
    website/app/page.tsx
  </files>
  <action>
    1. **Update AutopilotPanels.tsx**: Add staggered entrance animation.
       - Import `m`, `useReducedMotion` from motion/react, `cssEasing`, `cssDuration` from animation.ts
       - Add state: `heroComplete` (boolean, default false)
       - Add useEffect to listen for `hero-entrance-complete` event + 2000ms fallback timeout
       - Define container variant: `hidden: { opacity: 1 }`, `visible: { opacity: 1, transition: { staggerChildren: 0.15 } }`
       - Define panel variant: `hidden: { opacity: 0, y: 20, scale: 0.95 }`, `visible: { opacity: 1, y: 0, scale: 1, transition: { duration: 0.3, ease: cssEasing.standard } }`
       - If `useReducedMotion()`: show panels immediately without animation (animate="visible" regardless of heroComplete)
       - Desktop: Wrap inner flex in `<m.div variants={containerVariants} initial="hidden" animate={heroComplete || prefersReducedMotion ? "visible" : "hidden"}>`. Each panel wrapped in `<m.div variants={panelVariants}>` with the existing inline style for Z-positioning
       - Mobile: Same stagger pattern but without scale (panel variant uses only opacity and y)
       - CRITICAL: The `m.div` wrapper for each panel must NOT have overflow:hidden or any 3D-flattening property. It's just a motion wrapper with the inline style passed through.

    2. **Update Hero.tsx**: Integrate AutopilotPanels inside the hero section.
       - Import `AutopilotPanels` from `@/components/sections/autopilot-hero`
       - Add `<AutopilotPanels />` as a new full-width element below the grid:
         ```tsx
         <div className="container mx-auto">
           <div className="grid grid-cols-1 lg:grid-cols-2 ...">
             {/* existing HeroContent + PhoneMockup */}
           </div>

           {/* Autopilot Dashboard Panels - Phase 32 */}
           <div className="mt-12 lg:mt-16">
             <AutopilotPanels />
           </div>
         </div>
         ```
       - Adjust hero section class: Change `flex items-center` to `flex items-start` and ensure adequate top padding. The hero will now grow taller than 100dvh on desktop — this is intentional. The panels extend below the initial viewport, inviting scroll.
       - Keep `min-h-[100dvh]` — hero is at least full viewport, panels extend beyond.

    3. **Update page.tsx**: Remove the Phase 32 placeholder comment.
       - Delete or update the comment block: `{/* Phase 32 - Autopilot Hero Visualization - PLACEHOLDER ... */}` — replace with: `{/* Phase 32 - Autopilot Hero Visualization is inside <Hero /> */}`

    **RTL Check:** Entrance animations use y (vertical) and scale — both direction-agnostic. The stagger order follows source order which is Reviews -> Leads -> Activity (right to left in RTL, front to back).

    **Performance Check:** Entrance animation uses transform + opacity only (GPU). Completes in ~750ms total (3 panels x 300ms with 150ms stagger). After entrance, only periodic updates and CSS animations remain active.
  </action>
  <verify>
    - TypeScript compiles: `cd website && npx tsc --noEmit`
    - AutopilotPanels listens for hero-entrance-complete event
    - Hero.tsx imports and renders AutopilotPanels
    - page.tsx placeholder comment updated
    - `cd website && npm run build` succeeds (production build test)
    - grep for "useReducedMotion" in AutopilotPanels confirms accessibility
    - grep for "hero-entrance-complete" in AutopilotPanels confirms sync
  </verify>
  <done>
    AutopilotPanels has staggered entrance animation synced with hero completion. Panels are integrated into Hero.tsx as a full-width row below the 2-column grid. The hero section grows to accommodate panels, extending below the fold. page.tsx placeholder updated. Build succeeds.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Complete Autopilot Hero visualization with all animations and hero integration:
    - 3 dashboard panels entrance-animate with staggered fade-up after hero loads
    - Rating (4.8) counts up from 4.5 with spring physics
    - Every ~5-7 seconds, new items slide into panel lists (staggered across panels)
    - After 3-4 cycles, updates pause for 30 seconds
    - Green dots pulse, shimmer sweeps on Reviews panel
    - All animations respect prefers-reduced-motion
    - Panels live inside the Hero section, below the 2-column grid

    This is the final Phase 32 output.
  </what-built>
  <how-to-verify>
    1. Run: `cd website && npm run dev`
    2. Open: http://localhost:3000

    **Desktop Entrance Animation:**
    - [ ] Page loads, hero content appears first
    - [ ] ~1 second after hero entrance: panels fade in with stagger (Reviews -> Leads -> Activity)
    - [ ] Each panel slides up from 20px below and scales from 0.95 to 1
    - [ ] Rating number counts up from ~4.5 to 4.8 with spring easing

    **Continuous Animations:**
    - [ ] Green dots pulse gently on each panel header
    - [ ] Shimmer border sweeps on Reviews panel (front)
    - [ ] No shimmer on Leads or Activity panels

    **Periodic Updates (wait 5-10 seconds after entrance):**
    - [ ] Activity panel: new item slides in from top, existing items shift down, bottom item fades out
    - [ ] ~2s later: Leads panel receives a new lead card
    - [ ] ~2s later: Reviews panel receives a new review
    - [ ] Items animate smoothly without layout jumps
    - [ ] After 3-4 cycles: updates pause (watch for ~20-30 seconds of quiet)

    **Placement:**
    - [ ] Panels are INSIDE the hero section, below the headline/CTAs/phone mockup
    - [ ] Panels extend below the initial viewport fold (inviting scroll)
    - [ ] Smooth visual flow: hero content -> panels -> hero form

    **RTL Check:**
    - [ ] Panel cascade still correct: Reviews on right, Activity on left
    - [ ] New items animate vertically (not affected by RTL direction)
    - [ ] All Hebrew text still flows right-to-left

    **Reduced Motion Test (optional but recommended):**
    - In Chrome DevTools > Rendering > Emulate CSS media feature: prefers-reduced-motion: reduce
    - [ ] Panels appear immediately without animation
    - [ ] No periodic updates cycling
    - [ ] No pulsing dots
    - [ ] Content is fully visible and usable

    **Mobile:**
    - [ ] Stacked panels with entrance fade (no scale)
    - [ ] Periodic updates work in stacked layout
    - [ ] No performance issues (no jank)

    **Performance:**
    - [ ] No dropped frames during periodic updates (check via Chrome DevTools Performance)
    - [ ] No console errors or warnings

    **Run visual capture for comparison:**
    ```bash
    cd website && npm run visual:capture
    ```
    Compare output against Linear screenshots for overall visual quality.

    Type "approved" if the visualization tells the story "Findo runs your business while you sleep" through its live-updating panels. Describe issues if any.
  </how-to-verify>
  <resume-signal>Type "approved" or describe visual/animation issues to fix</resume-signal>
</task>

</tasks>

<verification>
After all tasks complete:
1. usePeriodicUpdates hook manages timed item cycling with pause behavior
2. All 3 panels have periodic updates with staggered timing
3. AutopilotPanels entrance animates with stagger synced to hero completion
4. Rating counts up with spring physics
5. AnimatePresence handles smooth item enter/exit with layout animation
6. All animations respect prefers-reduced-motion
7. Panels integrated into Hero.tsx, visible on homepage
8. page.tsx placeholder removed
9. Production build succeeds
10. User approved the complete animated visualization
</verification>

<success_criteria>
- Staggered entrance animation activates after hero entrance completes
- Numbers count up to final values with spring easing
- Periodic live updates cycle items in all 3 panels with 2s stagger between panels
- 3-4 cycles then 30s pause pattern works correctly
- All animations use GPU-only properties (transform, opacity)
- prefers-reduced-motion disables all motion
- Panels are inside Hero section, telling the "autopilot" story
- User approved the final visualization
</success_criteria>

<output>
After completion, create `.planning/phases/32-autopilot-hero-visualization/32-02-SUMMARY.md`
</output>
